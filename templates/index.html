<!DOCTYPE html>
<html>
<head>
    <title>Stock Dashboard</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

    <style>
        body { font-family: Arial; background:#111; color:white; }
        .box { background:#222; padding:15px; border-radius:10px; margin-top:15px; }
        a { color:#4af; }
    </style>
</head>
<body>

<h1>Stock Analysis</h1>

<form method="POST">
    <input name="ticker" placeholder="Enter ticker (AAPL)" required>
    <button type="submit">Search</button>
</form>

{% if error %}
<p style="color:red;">{{ error }}</p>
{% endif %}

{% if ticker %}
<h2>{{ ticker }}</h2>
{% endif %}

<!-- Chart -->
{% if fig_json %}
<div id="chart" class="box"></div>
<script>
    let fig = {{ fig_json | safe }};
    Plotly.newPlot("chart", fig.data, fig.layout);
</script>
{% endif %}

<!-- Prediction -->
{% if prediction %}
<div class="box">
    <h3>Prediction</h3>
    <p>{{ prediction }}</p>
</div>
{% endif %}

<!-- News -->
{% if news %}
<div class="box">
    <h3>Relevant News</h3>

    {% for n in news %}
    <div style="margin-bottom:12px;">
        <a href="{{ n.url }}" target="_blank"><b>{{ n.title }}</b></a>
        <p>{{ n.desc }}</p>

        <p>
            <b>Relevancy Score:</b> {{ n.relevancy }}<br>
            <b>FinBERT:</b> {{ n.sentiment }} ({{ n.sentiment_score }})
        </p>

        <hr>
    </div>
    {% endfor %}
</div>
{% endif %}

</body>
</html>
